---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import Layout from "../layouts/Layout.astro";

// Dynamically import all artwork images from the folder
const artworkModules = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/artwork/*.webp',
  { eager: true }
);

// Convert to array of { path, image } for captions and keys
const artworkItems = Object.entries(artworkModules).map(
  ([filePath, module]) => ({
    filePath,
    image: module.default,
  })
);

---
<Layout>
  <section class="prose mx-6 my-8">
    These pieces are my creationsâ€”from on-location photographs in Ahmedabad
    to vaporwave-inspired digital compositions. I began experimenting in
    Photoshop during college, and over time developed a style that blends
    pop-culture iconography with dreamy, retro-futuristic color palettes.
    Feel free to browse;  may take a moment to load low-res previews.
  </section>

  <div class="mx-4 mb-8">
    <h2 class="text-xl font-semibold mb-4">Gallery</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
      {artworkItems.map(({ filePath, image }) => {
        // Derive a caption from the file path
        const fileName = filePath.substring(filePath.lastIndexOf('/') + 1);
        const caption = fileName.replace(/\.webp$/, '').replace(/[-_]/g, ' ');

        return (
          <figure class="rounded-lg overflow-hidden shadow-lg">
            <Image
              src={image}
              alt={caption}
              quality="low"
              loading="lazy"
              class="w-full h-auto"
            />
            <figcaption class="p-2 text-center text-sm">{caption}</figcaption>
          </figure>
        );
      })}
    </div>
  </div>


</Layout>
